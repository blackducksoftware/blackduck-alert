package com.blackducksoftware.integration.hub.alert.processor.vulnerability;

import java.util.Map;

import com.blackducksoftware.integration.hub.alert.datasource.entity.NotificationCategoryEnum;
import com.blackducksoftware.integration.hub.alert.processor.NotificationProcessingModel;
import com.blackducksoftware.integration.hub.api.view.CommonNotificationState;
import com.blackducksoftware.integration.hub.notification.content.NotificationContent;
import com.blackducksoftware.integration.hub.notification.content.NotificationContentDetail;

public class VulnerabilityProcessingModel extends NotificationProcessingModel {
    private final Map<NotificationCategoryEnum, VulnerabilityStateTable> vulnerabiltyStateTableMap;

    public VulnerabilityProcessingModel(final NotificationContentDetail contentDetail, final CommonNotificationState commonNotificationState, final NotificationContent content, final NotificationCategoryEnum notificationType,
            final Map<NotificationCategoryEnum, VulnerabilityStateTable> vulnerabiltyStateTableMap) {
        super(contentDetail, commonNotificationState, content, notificationType);
        this.vulnerabiltyStateTableMap = vulnerabiltyStateTableMap;
    }

    public VulnerabilityStateTable getVulnerabilityStateTable(final NotificationCategoryEnum vulnerabilityNotificationType) {
        if (vulnerabiltyStateTableMap.containsKey(vulnerabilityNotificationType)) {
            return vulnerabiltyStateTableMap.get(vulnerabilityNotificationType);
        } else {
            return new VulnerabilityStateTable();
        }
    }
}
