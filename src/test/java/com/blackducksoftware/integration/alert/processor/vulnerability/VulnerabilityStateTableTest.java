package com.blackducksoftware.integration.alert.processor.vulnerability;

import static org.junit.Assert.assertEquals;

import java.util.List;

import org.junit.Test;

import com.blackducksoftware.integration.alert.datasource.entity.VulnerabilityEntity;
import com.blackducksoftware.integration.alert.enumeration.VulnerabilityOperationEnum;
import com.blackducksoftware.integration.alert.processor.vulnerability.VulnerabilityStateTable;

public class VulnerabilityStateTableTest {
    @Test
    public void testNonCollapsedList() {
        final VulnerabilityStateTable vulnStateTable = new VulnerabilityStateTable();
        VulnerabilityOperationEnum operation = VulnerabilityOperationEnum.ADD;
        vulnStateTable.addVulnerabilityData(operation, new VulnerabilityEntity("1", operation, 1L));
        vulnStateTable.addVulnerabilityData(operation, new VulnerabilityEntity("2", operation, 1L));

        operation = VulnerabilityOperationEnum.UPDATE;
        vulnStateTable.addVulnerabilityData(operation, new VulnerabilityEntity("3", operation, 1L));

        operation = VulnerabilityOperationEnum.DELETE;
        vulnStateTable.addVulnerabilityData(operation, new VulnerabilityEntity("4", operation, 1L));
        vulnStateTable.addVulnerabilityData(operation, new VulnerabilityEntity("5", operation, 1L));
        vulnStateTable.addVulnerabilityData(operation, new VulnerabilityEntity("6", operation, 1L));

        final List<VulnerabilityEntity> flatList = vulnStateTable.getVulnerabilityList();
        assertEquals(6, flatList.size());
    }
}
